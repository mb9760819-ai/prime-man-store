<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prime Man Store</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
background:#000;
color:#fff;
font-family:Arial;
}

.logo{
font-size:40px;
font-weight:bold;
text-align:center;
margin-top:40px;
}

.card{
background:#111;
color:#fff;
border:none;
}

.qty-btn{
width:40px;
height:40px;
}

.total-box{
background:#111;
padding:15px;
margin-top:20px;
border-radius:10px;
}
</style>
</head>

<body>

<div class="logo text-center">PRIME MAN STORE</div>

<div class="container mt-5">
<div class="row">

<!-- PRODUCT TEMPLATE -->
<script>
let products = [
{ id:1, name:"Baggy Nike Black" },
{ id:2, name:"Baggy Nike White" },
{ id:3, name:"Baggy Nike Gris" }
];
</script>

<div id="productsContainer" class="row"></div>

</div>
</div>

<div class="container">
<div class="total-box text-center">

<h5 id="totalText">المجموع: 0 DZD</h5>

<button class="btn btn-light mt-2" onclick="openOrder()">اطلب الآن</button>

</div>
</div>

<!-- MODAL -->
<div class="modal fade" id="orderModal">
<div class="modal-dialog">
<div class="modal-content p-3">

<h5>معلومات الطلب</h5>

<form id="orderForm">

<input type="hidden" id="orderDetails">

<input class="form-control my-2" id="name" placeholder="الاسم واللقب" required>
<input class="form-control my-2" id="phone" placeholder="رقم الهاتف" required>

<select class="form-select my-2" id="delivery" required>
<option value="">نوع التوصيل</option>
<option>للمنزل</option>
<option>للمكتب</option>
</select>

<select class="form-select my-2" id="state" required>
<option value="">اختر الولاية</option>
<option>(16) الجزائر العاصمة</option>
<option>(31) وهران</option>
<option>(25) قسنطينة</option>
<option>(19) سطيف</option>
<!-- تقدر تكمل باقي الولايات هنا -->
</select>

<button class="btn btn-success w-100 mt-2">ارسال الطلب</button>

</form>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>

emailjs.init("xqmosYYqEUpu4Gb1u");

let cart = {};

function createProducts(){

let container = document.getElementById("productsContainer");

products.forEach(p => {

cart[p.id] = {name:p.name, size:"M", qty:0};

container.innerHTML += `
<div class="col-md-4">
<div class="card text-center p-3">
<h4>${p.name}</h4>

<select class="form-select my-2" onchange="setSize(${p.id}, this.value)">
<option>M</option>
<option>L</option>
<option>XL</option>
<option>XXL</option>
</select>

<div class="d-flex justify-content-center align-items-center">
<button class="btn btn-light qty-btn" onclick="changeQty(${p.id}, -1)">-</button>
<span class="mx-3" id="qty${p.id}">0</span>
<button class="btn btn-light qty-btn" onclick="changeQty(${p.id}, 1)">+</button>
</div>

</div>
</div>
`;

});

}

function setSize(id, size){
cart[id].size = size;
}

function changeQty(id, change){

cart[id].qty += change;
if(cart[id].qty < 0) cart[id].qty = 0;

document.getElementById("qty"+id).innerText = cart[id].qty;

updateTotal();
}

function updateTotal(){

let totalQty = 0;

for(let id in cart){
totalQty += cart[id].qty;
}

let totalPrice = 0;

if(totalQty == 1) totalPrice = 2200;
else if(totalQty == 2) totalPrice = 4000;
else if(totalQty >= 3) totalPrice = totalQty * 2000;

document.getElementById("totalText").innerText =
"طلبت " + totalQty + " قطعة | المجموع: " + totalPrice + " DZD";

}

function openOrder(){

let details = "";
let totalQty = 0;

for(let id in cart){
if(cart[id].qty > 0){
details += cart[id].name + " | مقاس: " + cart[id].size + " | كمية: " + cart[id].qty + "\n";
totalQty += cart[id].qty;
}
}

if(totalQty == 0){
alert("اختر على الأقل منتج واحد");
return;
}

document.getElementById("orderDetails").value = details;

new bootstrap.Modal(document.getElementById('orderModal')).show();
}

document.getElementById("orderForm").addEventListener("submit", function(e){

e.preventDefault();

emailjs.send("service_33fq1pl","template_ir8p2n8",{
details: document.getElementById("orderDetails").value,
name: document.getElementById("name").value,
phone: document.getElementById("phone").value,
delivery: document.getElementById("delivery").value,
state: document.getElementById("state").value,
email:"mhmdbusniss@gmail.com"
}).then(function(){

alert("تم ارسال الطلب بنجاح");

});

});

createProducts();

</script>

</body>
</html>
